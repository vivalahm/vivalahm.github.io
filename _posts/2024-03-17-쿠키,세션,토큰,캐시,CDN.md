---
title: 쿠키, 세션, 토큰, 캐시, CDN
date: 2024-03-17 4:21:00 +09:00
categories: [쿠키, 세션, 토큰, 캐시, CDN]
tags:
  [
    쿠키,
    세션,
    토큰,
    캐시,
    CDN
  ]






---

### 목적: 효율적인 웹 운영과 사용을 위해 데이터가 저장되는 다섯 가지 개념인 쿠키, 세션, 토큰, 캐시, CDN 에 대해 알아본다.

- 반복되는 작업을 줄일수록 좋다.
- 웹사이트에 접속할때 마다 매번 로그인해야 한다면 웹사이트를 이용하는 것은 스트레스 일 것.
- 때문에 이러한 정보는 한 번 작성하거나 사용한 뒤에는 반복적으로 작업하지 않도록 저장해 두는 것이 효율적이다.
- 웹 환경에서 이처럼 반복적으로 사용되는 데이터나 정보를 종류와 특성에 맞게 저장하고 재활용하기 위해 여러 방식을 사용한다.



### 1. 브라우저에 저장되는 정보 <쿠키>

- 웹 서핑을 하면서 어떤 사이트에 들어가면 쿠키를 허용해 달라는 문구를 본적이 있을 것이다.
- 쿠키는 쇼핑 사이트에 로그인하지 않아도 장바구니에 물건을 담아두거나 검색 기록에서 이전에 입력했던 검색어들을 찾아볼 수 있다.
- 나의 웹 서핑 내역이 마케팅이나 광고에 활용되는 것도 쿠키를 통해 이루어짐.

`쿠키`는 크롬이나 사파리 같은 브라우저에 저장되는 작은 텍스트 조각으로, 브라우저는 사용자의 컴퓨터에 설치된 소프트웨어이므로 쿠키는 사용자가 갖고 있는 정보라 볼 수 있다.

이처럼 쿠키는 사용자에게 맡겨도 되는 정보만 저장한다.

- 쿠키는 당사자뿐만 아니라 제 3자가 조회하는 것도 가능하기 떄문에 개인 정보를 담은 내용이나 보안 상 민감한 정보를 저장하는 데에는 적합하지 않다.
- 남에게 탈취되거나 사용자에 의해 조작되어도 크게 문제 되지 않을 정보를 브라우저에 저장함으로써 웹사이트 이용을 편리하게 해주는 것이 쿠키이다.
- 예시로 웹툰 목록이나 웹 페이지 다크 모드 설정 여부 등과 같은 간단한 정보등을 쿠키 정보로 저장한다.

쿠키를 이해하는 것이 중요한 이유는 세션과 토큰의 구현에 있어서 쿠키가 중요한 역할을 담당하기 때문이다.



### 2. 서버가 나를 알아보는 방법 <세션>

- 웹사이트에 아이디와 비밀번호를 입력해서 로그인(인증)하면 해당 사이트의 회원에게만 허용된 기능들을 사용(인가)할 수 있다.
- 마이페이지를 클릭해서 내 정보를 볼 수 있고, 회원 정보 게시판의 글쓰기 버튼을 클릭해서 질문을 남기거나 리뷰를 쓸 수 도 있다.

문제는 이와 같은 클릭 하나하나 매번 서버에게 새로 보내는 익명 편지와도 같아 사이트에 로그인을 하는 등의 이전 행동들과 연결이 있지 않는 것 이다.

- 다시 말해 서버는 아이디와 비밀번호를 입력해 로그인에 성공한 사용자와 로그인한 다음 마이페이지 버튼을 누른 사용자가 동일 인물임을 알지 못한다.
- 그렇기 때문에 사용자가 사이트에 로그인한 상태라는 점을 서버에 인증하지 못하면 클릭 할 때마다 반복해서 아이디와 비밀번호를 서버에 제공해야 한다.

이러한 번거로움을 해결하기 위해 사용하는 것이 바로 `세션`이다.

- 사용자가 서버에 올바른 아이디와 비밀번호로 로그이니에 성공하면 서버는 세션 아이디라는 데이터를 만든다.
- 보통은 '2sd98dbawix4'와 같이 알파벳과 숫자가 혼합된 형식을 갖고 있다.
- 서버는 영화관에서 티켓을 보관용 부분만 찢어 건네주듯 세션 아이디를 사용자에게 전달하고, 메모리에 아이디 사본을 어떤 사용자의 것인지 적어서 보관
- 사용자는 서버로부터 받은 세션 아이디를 쿠키로 저장한 다음 앞으로의 모든 요청에 함께 전달한다.
- 친구 목록을 볼 때, 댓글을 작성하거나 삭제할 때, 구매한 상품 내역을 볼때 도 서버에게 세션 아이디를 적은 편지(쿠키)를 보낸다.

서버는 사용자에게 친구 목록을 보겠다는 요청을 받으면 그 편지(쿠키)에 세션 아이디가 적혀 있는지를 확인한다.

- 아이디가 있다면 서버가 보관하고 있는 세션 아이디 중에 동일한 정보가 있는지 찾아보고 그것이 누구의 계정인지도 알아낸다.
- 그렇게 쿠키를 보낸 사람이 누구인지 파악한 다음 해당 사용자의 친구 목록을 보내준다.

세션은 로그인 여부 등 사용자와 서버의 관계가 기억되어 보존되고 있는 상태를 말한다.

- 회사 마다 틀리겠지만, 우리 회사의 경우 Redis를 통해 세션을 저장하며 세션 내부에는 직렬화된 세션 아이디 및 Spring Security Attribute값이 들어간다
- 이 세션 내 속성을 통해 사용자 정보와 인가 리스트를 확인 한다.



### 3. 세션과 또 다른 로그인 유지 방식 <토큰>

- 세션 방식은 안전하고 효과적이지만 단점도 있다.
- 서버는 요청마다 함께 딸려 오는 세션 아이디를 바로바로 확인 할 수 있도록 로그인 사용자의 아이디를 메모리라는 공간에 올려둔다.
- 메모리에 올려둔 데이터를 빠르게 확인 할 수 있다는 장점이 있는 대신 공간이 한정되어 있다.
- 서버에 동시 접속하는 사용자가 많아지면 메모리 공간이 부족해져서 서버에 부하가 걸리고, 화면이 움직이지 않는 문제가 발생 할 수 있다.

하드디스크나 SSD 는 메모리 보다 저장 공간이 훨씬 넓지만, 저장된 정보를 꺼내는 데 시간이 오래걸리므로, 빠르고 많이 들어오는 요청에 맞게 세션 아이디를 찾아 확인하는 작업에는 용량이 적지만 더 빠른 메모리가 적합

- Redis는 이러한 인메모리 캐시로 세션에 적합하다.
- 세션역시 만료기간이 있으므로 적절한 TTL을 설정 해두면 용량을 절약 가능하다.

