---
title: 선착순 쿠폰 발급 시스템 (1) 발급 처리 구성도
date: 2024-02-22 13:41:00 +09:00
categories: [선착순 쿠폰 발급 시스템, Redis, 비동기 처리]
tags:
  [
    선착순 쿠폰 발급 시스템,
    Redis,
    비동기 처리
  ]



---

## 구성도

![image-20240221235229528](https://raw.githubusercontent.com/vivalahm/img/master/uPic/image-20240221235229528.png?token=ALT3VFSVPHJAPR2ESQYSAA3F2YHGW)

## 순서

- 유저의 요청을 받는 API 서버와 쿠폰을 실제로 발급하는 쿠폰 서버가 별도로 존재

1. `API SERVER`는 유저들의 요청을 처리해서 `Redis Cache`를 통해 발급 대상을 검증한다.
1. 검증된 대상은 쿠폰 발급 대기열 `큐`에 대기를 시킨다.
1. 선착순 쿠폰 발급 성공 여부를 반환한다.
1. 대기 큐를 `인터페이스`로 사용하여 쿠폰을 발급하는 서버로 넘긴다.
1. `쿠폰 발급 서버`는 해당 큐를 `폴링`하여 읽어서 `쿠폰 발급 트랜잭션`을 `Mysql`에 처리한다.

- 쿠폰 발급 기능은 `비동기`로 이루어진다.